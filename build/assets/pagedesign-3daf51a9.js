import{_ as C,S as b,z as x,C as S,y as I,o as a,c,a as E,f as B,g as v,b as e,t as _,n as w,i as h,F as f,j as y,k as L,v as q,m as p,r as k,p as j,e as P}from"./app-af524dac.js";const T={data(){return{modal:{active:!1,name:null,size:"md"},blockgender:!1,event_types:[],event_covers:[],event_templates:[],event:null,shownavbar:!0,loader:!1,position:"top-end",blockgender:!0,errorform:!1,errors:[],isSticky:!1,initialPosition:null,cropper:null,file:{file:null,miniature:null,status:0},extension:"",imgDefault:"",template:{id:null,filename:null},cover:{id:null,filename:null}}},mounted(){this.getdata(),window.addEventListener("scroll",this.handleScroll)},beforeUnmount(){window.removeEventListener("scroll",this.handleScroll)},methods:{async getdata(){this.loader=!0;try{const t={event:this.$route.params.name},[s,l]=await Promise.all([axios.post("/client/event",t),axios.get("/event_types")]);this.event=s.data.event,this.event.cover&&(this.cover.id=s.data.event.cover.id,this.cover.filename=s.data.event.cover.filename),this.event_covers=this.filtergender(s.data.event.type.covers,[this.event.gender]),this.event.template&&(this.template.id=s.data.event.template.id,this.template.filename=s.data.event.template.filename),this.event_templates=this.filtertemplates(s.data.event.type.templates,[this.event.gender]),s.data.event.type.gender==3?this.blockgender=!0:this.blockgender=!1,this.event_types=l.data.event_types,this.loader=!1,this.$nextTick(()=>{let d=document.getElementById("quick-container");this.initialPosition=this.$refs.quickAccess.getBoundingClientRect().top+window.pageYOffset,d.style.height=this.$refs.quickAccess.offsetHeight+"px"})}catch(t){console.log(t),this.loader=!1,this.notification("Se ha presentado un error","error")}},validate(){this.errors=[],this.file.status==1&&this.errors.push("Dale aceptar la foto del perfil"),this.event.gender==null&&this.errors.push("Seleccionar un género"),this.cover.id==null&&this.errors.push("Seleccionar portada"),this.template.id==null&&this.errors.push("Seleccionar plantilla"),this.errors.length>0&&this.notification(this.errors[0],"warning")},savedata(){if(this.validate(),this.errors.length==0){this.loader=!0;const s={headers:{"content-type":"multipart/form-data"}};var t=new FormData;t.append("id",this.event.id),t.append("type",this.event.type.id),t.append("gender",this.event.gender),t.append("profile",this.file.file),t.append("profileextension",this.extension),t.append("cover",this.cover.id),t.append("template",this.template.id),axios.post("/client/event/savedesign",t,s).then(l=>{this.errors=l.data.errors,l.data.success?this.notification("Diseño guardado exitosamente","success"):this.notification(this.errors[0],"warning"),this.loader=!1})}},select(t){document.querySelectorAll(".dropdown-container").forEach(function(d){d.id!=t&&d.classList.remove("active")}),document.getElementById(t).classList.toggle("active")},closedrop(){document.querySelectorAll(".dropdown-container").forEach(function(s){s.classList.remove("active")})},set_type(t){this.event.type=t,t.gender==3?(this.event.gender=0,this.blockgender=!0,this.event_covers=this.filtergender(t.covers,[t.gender]),this.event_templates=this.filtertemplates(t.templates,[t.gender])):(this.event.gender=null,this.blockgender=!1),this.event.type.id==t.id,this.closedrop()},setgender(t){this.event.gender=t,this.event_covers=this.filtergender(this.event.type.covers,[t]),this.event_templates=this.filtertemplates(this.event.type.templates,[t]),this.closedrop()},filtergender(t,s){return t.filter(l=>s.includes(l.gender))},filtertemplates(t,s){return t.filter(l=>s.includes(l.gender))},setcover(t){this.cover.id=t.id,this.cover.filename=t.filename,this.closedrop()},settemplate(t){this.template.id=t.id,this.template.filename=t.filename},getscreenwidth(){this.position="top-end",window.screen.width<768&&(this.position="top")},notification(t,s){this.getscreenwidth(),b.mixin({toast:!0,position:this.position,showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:d=>{d.addEventListener("mouseenter",b.stopTimer),d.addEventListener("mouseleave",b.resumeTimer)}}).fire({icon:s,title:t})},onlyNumbers(t,s,l){let d=window.Event?t.which:t.keyCode;d==43||d>=48&&d<=57?(t.target.value.length>s&&t.preventDefault(),s==8&&l<9&&d<57&&(t.preventDefault(),this.notification("El primer número debe ser 9","warning"))):t.preventDefault()},cutnumber(t,s,l){if(t.target.value>0)return parseInt(t.target.value.slice(0,l));if(s>0&&(t.target.value=parseInt(s.toString().slice(0,l)),s>9&&l==9&&(this.validatePhone(s)||(this.notification("El número debe empezar por 9","warning"),t.target.value="",this.user.phone=""))),t.target.value=="")return""},cuttext(t,s,l){t.target.value=s.slice(0,l)},handleScroll(){x(()=>{if(this.event&&this.$refs.Navbar){document.querySelector(".main-profile");const t=this.initialPosition;document.getElementById("quick-container"),this.isSticky=window.pageYOffset>t-this.$refs.Navbar.$el.offsetHeight,this.isSticky?this.$refs.quickAccess.style.top=this.$refs.Navbar.$el.offsetHeight+"px":this.$refs.quickAccess.style.top="0px"}})},activemodal(){this.modal.active=!0;const t=document.getElementById("modal");setTimeout(()=>{t.classList.toggle("active")},20)},closemodal(){document.getElementById("modal").classList.remove("active"),setTimeout(()=>{this.modal.active=!1},300)},clearData(){this.cropper&&(this.resetCropper(),this.clearCropper(),this.destroyCropper()),this.file=null},clearCropper(){this.cropper.clear()},resetCropper(){this.cropper.reset()},destroyCropper(){this.cropper.destroy()},initCropper(){let t=document.getElementById("previewImgService");this.cropper=null,t&&(this.cropper=new S(t,{aspectRatio:1/1,viewMode:2,minCropBoxWidth:50,moveable:!1,crop(s){}}))},changePicture(t){if(t.target.files[0]){this.file.status=1;let s=t.target.files[0],l=t.target.files[0].name.split(".");this.extension=l[l.length-1];let d=new FileReader;d.readAsDataURL(s),d.onload=i=>{const n=new Image;n.src=i.target.result,n.onload=()=>{let m=document.getElementById("previewImgService");m.src=n.src,m.scrollIntoView({block:"center"}),this.cropper&&(this.resetCropper(),this.clearCropper(),this.destroyCropper()),this.initCropper()},n.onerror=()=>{this.file.status=0,this.extension=null,this.notification("Error de archivo","warning"),this.resetCropper(),this.clearCropper(),this.destroyCropper()}},this.dropinput()}},setcutedphoto(){this.cropper.getCroppedCanvas({width:800,height:800}).toBlob(t=>{this.compressImage(t,"jpeg",340,340,s=>{URL.createObjectURL(s),this.file.file=s,this.file.miniature=URL.createObjectURL(s),this.file.status=2,document.getElementById("imagecontainer").scrollIntoView({block:"center",inline:"center"})}),this.resetCropper(),this.clearCropper(),this.destroyCropper(),this.dropinput()})},dropcutedphoto(){this.file.status=0,this.resetCropper(),this.clearCropper(),this.destroyCropper(),this.dropinput()},dropinput(){const t=document.getElementById("miniatureservice");t.value=null},compressImage(t,s,l,d,i){const n=new Image;n.src=URL.createObjectURL(t),n.onload=()=>{const m={maxWidth:l,maxHeight:d,quality:.9,mimeType:"image/jpeg",convertSize:5e6,success(g){const o=new File([g],t.name,{type:"image/jpeg"});i(o)},error(g){console.error("Error al comprimir la imagen",g.message),i(t)}};new I(t,m)}}}},r=t=>(j("data-v-fa8d6be6"),t=t(),P(),t),R={class:"landing-page-desktop"},A={class:"main-profile"},N={key:0,class:"content-design"},U={class:"index-page-links"},F=r(()=>e("div",{class:"material-symbols-outlined highlight pointer"},"arrow_forward",-1)),V=r(()=>e("a",{href:"/cliente/eventos",class:"body-small"},"Mis Eventos",-1)),z=p(),H=r(()=>e("div",{class:"material-symbols-outlined highlight pointer"},"arrow_forward",-1)),O=p(),D=["href","textContent"],M=r(()=>e("div",{class:"avatar-main"},[e("div",null,[e("span",{class:"headline-medium"},"Diseña tu página")])],-1)),G={id:"quick-container"},W=["href"],J=r(()=>e("span",{class:"material-symbols-outlined"},"visibility",-1)),Y=p(" Ver invitación"),K=[J,Y],Q=r(()=>e("span",{class:"material-symbols-outlined"},"save",-1)),X=p(" Guardar"),Z=[Q,X],$={class:"design-form"},ee={class:"dropdown-box",id:"typecontainer"},te=r(()=>e("label",{class:"label-medium"},[p("Tipo de evento"),e("span",{class:"text-red"},"*")],-1)),se={class:"dropdown-container",id:"type"},ie=["textContent"],oe=r(()=>e("span",{class:"material-symbols-outlined icon"},"expand_more",-1)),ne={class:"dropdown-content"},le={class:"options"},re=["onClick","textContent"],ae={key:0,class:"dropdown-box",id:"gendercontainer"},ce=r(()=>e("label",{class:"label-medium"},[p("Género"),e("span",{class:"text-red"},"*")],-1)),de={class:"dropdown-container",id:"gender"},pe=["disabled"],he=["textContent"],me=r(()=>e("span",{class:"material-symbols-outlined icon"},"expand_more",-1)),ue={class:"dropdown-content"},ve={class:"options"},_e={class:"avatar-main",id:"imagecontainer"},ge={class:"avatar-buttons"},fe={class:"default-avatar"},ye={key:0,class:"avatar-img small"},be=["src"],we={key:1,class:"avatar-img small"},ke=["src"],Ce={key:2,class:"avatar-initial"},xe=r(()=>e("span",{class:"material-symbols-outlined text-white"},"photo",-1)),Se=[xe],Ie={class:"avatar-options"},Ee=r(()=>e("div",null,[e("span",{class:"label-large"},"Agrega tu foto de perfil")],-1)),Be=r(()=>e("div",null,[e("span",{class:"body-medium"},"Formatos: JPG, PNG, JFIF o TIFF")],-1)),Le=r(()=>e("label",{for:"miniatureservice",class:"button small secondary-dark"},[e("span",{class:"material-symbols-outlined"},"add_photo_alternate"),p("Subir logo")],-1)),qe={key:0,class:"avatar-options"},je={class:"btn-group-avatar"},Pe=r(()=>e("span",{class:"material-symbols-outlined text-green"},"check",-1)),Te=p(" Aceptar"),Re=[Pe,Te],Ae=r(()=>e("span",{class:"material-symbols-outlined text-red"},"close",-1)),Ne=p(" Cancelar"),Ue=[Ae,Ne],Fe=r(()=>e("div",{class:"upload-cropper-container"},[e("div",{class:"upload-cropper"},[e("img",{alt:"",id:"previewImgService"})])],-1)),Ve={class:"dropdown-box",id:"covercontainer"},ze=r(()=>e("label",{class:"label-medium"},[p("Portada de la invitación"),e("span",{class:"text-red"},"*")],-1)),He={class:"dropdown-container",id:"cover"},Oe={key:0,class:"cover-img"},De=["src"],Me={key:1,class:"body-medium dropd-text"},Ge=r(()=>e("span",{class:"material-symbols-outlined icon"},"expand_more",-1)),We={class:"dropdown-content"},Je={class:"options cover"},Ye=["onClick"],Ke=["src"],Qe={class:"input-group-column"},Xe=r(()=>e("label",{class:"label-medium"},[p("Seleccionar Plantilla"),e("span",{class:"text-red"},"*")],-1)),Ze={class:"template-list"},$e={class:"template-item"},et=["onClick"],tt=["src"],st={class:"text-center"},it=["onClick","textContent"],ot={class:"modal-shadow"},nt={class:"modal-header"},lt=r(()=>e("div",{claas:""},null,-1)),rt=p("Cerrar "),at=r(()=>e("span",{class:"material-symbols-outlined"},"close",-1)),ct=[rt,at],dt={key:0,class:"modal-body"},pt={class:"icon-list-container"},ht=["onClick"],mt=["src"],ut={key:1,class:"modal-body"},vt=r(()=>e("div",null,[e("span",{class:"title-small"},"Seleccionar Tipo:")],-1)),_t={class:"option-list"},gt=["textContent","onClick"];function ft(t,s,l,d,i,n){const m=k("nav-bar"),g=k("loader");return a(),c("div",R,[E(m,{shownavbar:i.shownavbar,ref:"Navbar"},null,8,["shownavbar"]),i.loader?(a(),B(g,{key:0})):v("",!0),e("div",A,[i.event?(a(),c("div",N,[e("div",U,[F,V,z,H,O,e("a",{href:"/cliente/evento/"+i.event.url_edit,class:"body-small",textContent:_(i.event.type.name+" de "+i.event.name)},null,8,D)]),M,e("div",G,[e("div",{ref:"quickAccess",class:w({"quick-access":!0,sticky:i.isSticky})},[e("a",{href:i.event.url,target:"_blank",class:"button small secondary quick"},K,8,W),e("button",{class:"button small primary quick",onClick:s[0]||(s[0]=o=>n.savedata())},Z)],2)]),e("div",$,[e("div",ee,[te,e("div",se,[e("button",{class:"dropdown dropdown-small",onClick:s[1]||(s[1]=h(o=>n.select("type"),["stop"]))},[e("span",{class:"body-medium dropd-text",textContent:_(i.event.type.id?i.event.type.name:"Seleccionar")},null,8,ie),oe]),e("div",ne,[e("ul",le,[(a(!0),c(f,null,y(i.event_types,(o,u)=>(a(),c("li",{class:"label-small",onClick:h(yt=>n.set_type(o),["stop"]),textContent:_(o.name),key:u},null,8,re))),128))])])])]),i.blockgender?v("",!0):(a(),c("div",ae,[ce,e("div",de,[e("button",{class:"dropdown dropdown-small",onClick:s[2]||(s[2]=h(o=>n.select("gender"),["stop"])),disabled:i.blockgender},[e("span",{class:"body-medium dropd-text",textContent:_(i.event.gender!=null?i.event.gender==0?"Unisex":i.event.gender==1?"Hombre":"Mujer":"Seleccionar")},null,8,he),me],8,pe),e("div",ue,[e("ul",ve,[e("li",{class:"label-small",onClick:s[3]||(s[3]=h(o=>n.setgender(1),["stop"]))},"Hombre"),e("li",{class:"label-small",onClick:s[4]||(s[4]=h(o=>n.setgender(2),["stop"]))},"Mujer")])])])])),e("div",_e,[e("div",ge,[e("div",fe,[i.file.miniature?(a(),c("div",ye,[e("img",{src:i.file.miniature},null,8,be)])):i.event.profile_photo?(a(),c("div",we,[e("img",{src:i.event.profileaws},null,8,ke)])):(a(),c("div",Ce,Se))]),e("div",Ie,[Ee,Be,e("div",null,[e("input",{type:"file",name:"miniatureservice",id:"miniatureservice",class:"input-file",onChange:s[5]||(s[5]=(...o)=>n.changePicture&&n.changePicture(...o)),onClick:s[6]||(s[6]=o=>n.dropinput()),accept:"image/x-png,image/jpeg,image/jpg,image/tiff,image/jfif"},null,32),Le])])]),i.file.status==1?(a(),c("div",qe,[e("div",je,[e("button",{class:"button small tertiary",onClick:s[7]||(s[7]=(...o)=>n.setcutedphoto&&n.setcutedphoto(...o))},Re),e("button",{class:"button small tertiary",onClick:s[8]||(s[8]=(...o)=>n.dropcutedphoto&&n.dropcutedphoto(...o))},Ue)]),Fe])):v("",!0)]),e("div",Ve,[ze,e("div",He,[e("button",{class:"dropdown dropdown-small",onClick:s[9]||(s[9]=h(o=>n.select("cover"),["stop"]))},[i.cover.id?(a(),c("div",Oe,[e("img",{src:"/img/covers/"+i.cover.filename},null,8,De)])):(a(),c("span",Me,"Seleccionar")),Ge]),e("div",We,[e("ul",Je,[(a(!0),c(f,null,y(i.event_covers,o=>(a(),c("div",{class:"cover-img",onClick:u=>n.setcover(o)},[e("img",{src:"/img/covers/"+o.filename},null,8,Ke)],8,Ye))),256))])])])]),e("div",Qe,[Xe,e("div",Ze,[(a(!0),c(f,null,y(i.event_templates,o=>(a(),c("div",$e,[e("div",{class:"template-miniature",onClick:u=>n.settemplate(o)},[e("img",{src:"/img/templates_mini/"+o.filename},null,8,tt)],8,et),e("div",st,[e("button",{class:w(["button medium",i.template.id==o.id?"primary":"tertiary"]),onClick:u=>n.settemplate(o),textContent:_(i.template.id==o.id?"Seleccionado":"Seleccionar")},null,10,it)])]))),256))])])])])):v("",!0),L(e("div",ot,[e("div",{class:w(["modal-container",i.modal.size]),onClick:s[11]||(s[11]=h(()=>{},["stop"])),id:"modal"},[e("div",nt,[lt,e("div",null,[e("button",{class:"button small tertiary",onClick:s[10]||(s[10]=h(o=>n.closemodal(!0),["stop"]))},ct)])]),i.modal.name=="icons"?(a(),c("div",dt,[e("div",pt,[(a(!0),c(f,null,y(t.icons,o=>(a(),c("div",{class:"button medium outlined",onClick:u=>t.setinfoicon(o)},[e("img",{class:"",src:"/img/othericons/"+o.file},null,8,mt)],8,ht))),256))])])):v("",!0),i.modal.name=="relativetypes"?(a(),c("div",ut,[vt,e("div",_t,[(a(!0),c(f,null,y(t.relativetypes,o=>(a(),c("button",{class:"button small secondary",textContent:_(o.name),onClick:h(u=>t.setrelativetype(o),["stop"])},null,8,gt))),256))])])):v("",!0)],2)],512),[[q,i.modal.active]])])])}const wt=C(T,[["render",ft],["__scopeId","data-v-fa8d6be6"]]);export{wt as default};
